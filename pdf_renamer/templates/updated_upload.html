<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Renamer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 2rem;
        }
        h2 {
            margin-top: 2rem;
        }
        .drag-drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 1rem;
            cursor: pointer;
        }
        .drag-drop-area.dragover {
            background-color: #f0f0f0;
        }
        input[type="file"] {
            display: none;
        }
        button {
            padding: 0.5rem 1rem;
            font-size: 1rem;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>PDF Renamer</h1>

    <!-- Form for renaming by customer number -->
    <h2>Rename by Customer Number</h2>
    <form method="post" action="/upload" enctype="multipart/form-data">
        <div id="drop-area" class="drag-drop-area">Drag &amp; drop PDFs here or click to select files</div>
        <input type="file" id="files" name="files" accept="application/pdf" multiple required>
        <button type="submit">Upload and Rename (Customer)</button>
    </form>

    <!-- Form for renaming by invoice number -->
    <h2>Rename by Invoice Number</h2>
    <form method="post" action="/upload_invoice" enctype="multipart/form-data">
        <div id="drop-area-inv" class="drag-drop-area">Drag &amp; drop PDFs here or click to select files</div>
        <input type="file" id="invoice-files" name="files" accept="application/pdf" multiple required>
        <button type="submit">Upload and Rename (Invoice)</button>
    </form>


    <!-- Form for renaming Sales Order PDFs -->
    <h2>Rename Sales Order</h2>
    <form method="post" action="/upload_salesorder" enctype="multipart/form-data">
        <div id="drop-area-so" class="drag-drop-area">Drag &amp; drop PDFs here or click to select files</div>
        <input type="file" id="salesorder-files" name="files" accept="application/pdf" multiple required>
        <button type="submit">Upload and Rename (Sales Order)</button>
    </form>

    <script>
        /**
         * Generic drag and drop handler for file inputs. When the user
         * drags a file over the drop area, we highlight it. When they drop
         * the file, we assign it to the associated file input. Clicking
         * the drop area also triggers the file picker.
         */
        function setupDragDrop(dropAreaId, fileInputId) {
            const dropArea = document.getElementById(dropAreaId);
            const fileInput = document.getElementById(fileInputId);

            // Highlight drop area when file is dragged over
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropArea.classList.add('dragover');
                }, false);
            });

            // Remove highlight when drag leaves or ends
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropArea.classList.remove('dragover');
                }, false);
            });

            // Store the default text (not HTML) so we can restore it when no files are selected
            const defaultText = dropArea.textContent;

            // Helper function to update the drop area with a preview of selected files
            function updatePreview() {
                if (fileInput.files && fileInput.files.length > 0) {
                    const names = Array.from(fileInput.files).map(f => f.name).join(', ');
                    dropArea.textContent = names;
                } else {
                    // Restore the original text when no files are selected
                    dropArea.textContent = defaultText;
                }
            }

            // Handle dropped files
            dropArea.addEventListener('drop', (e) => {
                fileInput.files = e.dataTransfer.files;
                updatePreview();
            });

            // Update preview when files are selected via the file dialog
            fileInput.addEventListener('change', updatePreview);

            // Trigger file input when clicking drop area
            dropArea.addEventListener('click', () => {
                fileInput.click();
            });
        }

        // Initialize drag & drop for each form
        setupDragDrop('drop-area', 'files');
        setupDragDrop('drop-area-inv', 'invoice-files');
        setupDragDrop('drop-area-so', 'salesorder-files');
    </script>
</body>
</html>