<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF Renamer</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 2rem;
}

h2 {
    margin-top: 2.5rem;
}

.drag-drop-area {
    border: 2px dashed #ccc;
    border-radius: 8px;
    padding: 1.5rem;
    text-align: center;
    cursor: pointer;
    margin-bottom: 1rem;
}

.drag-drop-area.dragover {
    background-color: #f0f0f0;
}

.file-list {
    margin-bottom: 1rem;
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.3rem 0;
}

.file-item button {
    background: none;
    border: none;
    color: red;
    font-size: 1.2rem;
    cursor: pointer;
}

input[type="file"] {
    display: none;
}

button.submit-btn {
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    cursor: pointer;
}
</style>
</head>

<body>

<h1>PDF Renamer</h1>

<!-- ================= SALES ORDER ================= -->

<h2>Rename Sales Order</h2>
<form method="post" action="/upload_salesorder" enctype="multipart/form-data">
    <div id="drop-area" class="drag-drop-area">
        Drag & drop PDFs here or click to select files
    </div>

    <div id="file-list" class="file-list"></div>

    <input
        type="file"
        id="file-input"
        name="files"
        accept="application/pdf"
        multiple
        required
    >

    <button class="submit-btn" type="submit">Upload and Rename</button>
</form>

<script>
const dropArea = document.getElementById("drop-area");
const fileInput = document.getElementById("file-input");
const fileListEl = document.getElementById("file-list");

let files = [];

function syncInputFiles() {
    const dataTransfer = new DataTransfer();
    files.forEach(f => dataTransfer.items.add(f));
    fileInput.files = dataTransfer.files;
}

function renderFileList() {
    fileListEl.innerHTML = "";

    files.forEach((file, index) => {
        const div = document.createElement("div");
        div.className = "file-item";

        const span = document.createElement("span");
        span.textContent = file.name;

        const btn = document.createElement("button");
        btn.innerHTML = "âœ•";
        btn.onclick = () => {
            files.splice(index, 1);
            syncInputFiles();
            renderFileList();
        };

        div.appendChild(span);
        div.appendChild(btn);
        fileListEl.appendChild(div);
    });
}

function addFiles(newFiles) {
    for (const file of newFiles) {
        if (!files.some(f => f.name === file.name && f.size === file.size)) {
            files.push(file);
        }
    }
    syncInputFiles();
    renderFileList();
}

/* Drag events */
["dragenter", "dragover"].forEach(e =>
    dropArea.addEventListener(e, ev => {
        ev.preventDefault();
        dropArea.classList.add("dragover");
    })
);

["dragleave", "drop"].forEach(e =>
    dropArea.addEventListener(e, ev => {
        ev.preventDefault();
        dropArea.classList.remove("dragover");
    })
);

dropArea.addEventListener("drop", e => {
    addFiles(e.dataTransfer.files);
});

dropArea.addEventListener("click", () => {
    fileInput.click();
});

fileInput.addEventListener("change", () => {
    addFiles(fileInput.files);
});
</script>

</body>
</html>
